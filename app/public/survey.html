<!--Need to do some serious css work-->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>FriendFinder</title>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">


        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/css/bootstrap-select.min.css">

        <!-- Latest compiled and minified JavaScript -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/bootstrap-select.min.js"></script>
        <style>
            body {background-color: powderblue;}
            h2   {color: blue;}
            h3   {color: blue;}
            h4   {color: blue;}
            h5   {color: blue;}
            
            </style>
    </head>
    <body>
        <!--survey starts-->
        <div class="container">
            <h2>Survey Questions</h2>
            <hr>

            <h3><b>Tell us about yourself!</b></h3>
            <h4 class="mainInput">Name (Required) <span class="error text-danger"></span> </h4>
            <input type="text" name="" id="name" class="form-control">

            <h4 class="mainInput">Link to Photo Image (Required) <span class="error text-danger"></span> </h4>
            <input type="text" name="" id="image" class="form-control">

            <hr>

            <h3 class="question"><b>Question 1</b></h3>
            <h4>You are the first to take charge in social gatherings or group projects.</h4>
            <select class="selectpicker" id="q1" title="Choose one of the following...">
                <option value="1">1 (Not at all!)</option>
                <option value="2">2 </option>
                <option value="3">3 (maybe...)</option>
                <option value="4">4 </option>
                <option value="5">5 (This is totally me!)</option>
            </select>

            <h3 class="question"><b>Question 2</b></h3>
            <h4>Your best friend's birthday is coming up.  Their one wish is a chocolate cake that wil take you all day to make.  How likely are you to make the cake?</h4>
            <select  class="selectpicker" id="q2" title="Choose one of the following...">
              <option value="1">1 (Not at all!)</option>
              <option value="2">2 </option>
              <option value="3">3 (maybe...)</option>
              <option value="4">4 </option>
              <option value="5">5 (This is totally me!)</option>
            </select>


            <h3 class="question"><b>Question 3</b></h3>
            <h4> Your friend is sick and wants to you to keep them company all day and watch Netflix with them.  You already have amazing plans.  How likely are you to cancel your plans?</h4>
            <select class="selectpicker" id="q3" title="Choose one of the following...">
              <option value="1">1 (Not at all!)</option>
              <option value="2">2 </option>
              <option value="3">3 (maybe...)</option>
              <option value="4">4 </option>
              <option value="5">5 (This is totally me!)</option>
            </select>


            <h3 class="question"><b>Question 4</b></h3>
            <h4>You have plans with your friend but they are being guarded by a large angry goose. The only way to get to your friend is to fight the goose. How likely are you to commit to the fight?</h4>
            <select class="selectpicker" id="q4" title="Choose one of the following...">
              <option value="1">1 (Not at all!)</option>
              <option value="2">2 </option>
              <option value="3">3 (maybe...)</option>
              <option value="4">4 </option>
              <option value="5">5 (This is totally me!)</option>
            </select>


            <h3 class="question"><b>Question 5</b></h3>
            <h4> Your friend has been captured by a evil sea witch. The only way to save them is by wrangling the slippery, ill-tempered sea otters that guard the sea dungeon. How likely are you to wrangle the otters?</h4>
            <select class="selectpicker" id="q5" title="Choose one of the following...">
              <option value="1">1 (Not at all!)</option>
              <option value="2">2 </option>
              <option value="3">3 (maybe...)</option>
              <option value="4">4 </option>
              <option value="5">5 (This is totally me!)</option>
            
            </select>


            <h3 class="question"><b>Question 6</b></h3>
            <h4> Your friend turns out to be a creature that can only survive by feasting on the souls of the innocent. Do you help your friend find victims to stay alive?</h4>
            <select class="selectpicker" id="q6" title="Choose one of the following...">
              <option value="1">1 (Not at all!)</option>
              <option value="2">2 </option>
              <option value="3">3 (maybe...)</option>
              <option value="4">4 </option>
              <option value="5">5 (This is totally me!)</option>
            </select>


            <h3 class="question"><b>Question 7</b></h3>
            <h4> You innocently unlock your friends phone.  How much do you want to scroll through their photos, texts, etc?</h4>
            <select class="selectpicker" id="q7" title="Choose one of the following...">
              <option value="1">1 (Not at all!)</option>
              <option value="2">2 </option>
              <option value="3">3 (maybe...)</option>
              <option value="4">4 </option>
              <option value="5">5 (This is totally me!)</option>
            </select>

            <h3 class="question"><b>Question 8</b></h3>
            <h4>You text your friend but get no response.  How likely are you to text them every 3 - 4 minutes until they answer?</h4>
            <select class="selectpicker" id="q8" title="Choose one of the following...">
              <option value="1">1 (Not at all!)</option>
              <option value="2">2 </option>
              <option value="3">3 (maybe...)</option>
              <option value="4">4 </option>
              <option value="5">5 (This is totally me!)</option>
            </select>

            <h3 class="question"><b>Question 9</b></h3>
            <h4>You are at a bar with friends.  How likely are you to order a round?</h4>
            <select class="selectpicker" id="q9" title="Choose one of the following...">
              <option value="1">1 (Not at all!)</option>
              <option value="2">2 </option>
              <option value="3">3 (maybe...)</option>
              <option value="4">4 </option>
              <option value="5">5 (This is totally me!)</option>
            </select>

            <h3 class="question"><b>Question 10</b></h3>
            <h4>You are invited to go camping in the woods with no bathrooms available.  How much do you want to go?</h4>
            <select class="selectpicker" id="q10" title="Choose one of the following...">
              <option value="1">1 (Not at all!)</option>
              <option value="2">2 </option>
              <option value="3">3 (maybe...)</option>
              <option value="4">4 </option>
              <option value="5">5 (This is totally me!)</option>
            </select>

            <br>
            <br>

            <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit">Make my Match!</button>

            

        </div>
        <!-- survey end -->

        <!-- modal for displaying match -->
        <div id="myModal" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content text-center">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Here's your new BAE BFF Bestie!</h4>
                    </div>
                    <div class="modal-body">
                        <img id="modalImage" class="well" src="" alt="" height="300">
                        <h3 id="modalName" class="text-danger"></h3>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <script type="text/javascript">
            $(document).ready(function () {
                //submit button
                $( '#submit' ).on( 'click', function ( event ) {
                    event.preventDefault();
                    let newFriend = {};
                    //check input
                    let inputComplete = false;
                    //gets input
                    let name = $( '#name' ).val().trim();
                    let photo = $( '#image' ).val().trim();
                    //warning if no pic or name
                    if ( name === '' || photo === '') {
                        inputComplete = false;
                        $( '.error' ).empty();
                        $( '.error' ).text( '  You must fill out this field!' )
                    } else {
                        inputComplete = true;
                    }
                    if ( inputComplete ) {
                        $( '.error' ).empty();
                        let newFriend = {
                            name,
                            photo,
                            scores:[]
                        }
                        
                        for ( let i = 1; i <= 10; i++ ) {
                            let score = $( '#q'+ i ).val() || "3"
                            newFriend.scores.push( score );
                            $( '#q'+ i ).val('').selectpicker('refresh');
                        }
                        //clear input
                        $( '#name' ).val( '' );
                        $( '#image' ).val( '' );
                        //new user gets put in api
                        $.post("/api/friends", newFriend)
                            .done(function(data) {   
                            console.log('data:',data)
                        });
                        //getting best match data and puts in the modal
                        $.get("/bestFriend", function (data2) {
                            $('#myModal').modal('toggle');
                            $('#modalName').text(data2.friend.name);
                            $('#modalImage').attr("src", data2.friend.photo);
                        });	
                    }
                });
            });
        </script>
    </body>
</html>